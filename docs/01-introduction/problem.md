---
sidebar_position: 2
---

# 課題

デジタルアーカイブのためのDBMSがスキーマ定義・入稿サイクルを支援しようとしたとき、そのDBMSはどのような特性を持つべきだろうか。

- **特性1: トランザクション:**
  データの保存時にDBMSの故障に見舞われても、データは一貫性を保つことが望ましい。
- **特性2: Not KVS:**
  範囲検索が事実上不可能なKVSでは、応用範囲が著しく狭まる。
- **特性3: NULL値:**
  あるスキーマに入れるべき資料に、一部フィールドに関する欠損があることはままある。非存在を表すNULL値があることが望ましい。
- **特性4: スキーマからフィールドを削除する際に、入稿済みのレコードのデータが欠損しない:**
  例えば、「 "体験談" フィールドを "被爆者" スキーマから他のスキーマ移すことにしたので、第一手として "被爆者" スキーマから "体験談" フィールドを削除する」という操作をした場合、多くのDBMSでは体験談のデータが失われる。これを避けるために通常はマイグレーション計画を立てて実施するのだが、マイグレーション計画なく、よりカジュアルにスキーマ定義・入稿サイクルを繰り返しても、データ欠損がないことが保証されると恩恵がある。
- **特性5: スキーマにフィールドを追加する際に、非NULLとして追加できるし、入稿済みのレコードにおかしな「デフォルト値」が入らない:**
  例えば、 `"顧客" スキーマに "年齢" フィールドを、非NULLで追加する` ケースを考える。一部のDBMS（SQL Serverなど）においては、既にスキーマにレコードが存在する場合、非NULLなフィールド追加は許容されない（エラーになる）。また、その他のDBMS（MySQLなど）は、エラーにはならないが既存のレコードに無理矢理とも言えるデフォルト値を入れる。例えば整数型のフィールドに 0 を入れるような実装がある。過去に入稿した "顧客" のレコードに対し、 "年齢" フィールドに 0 が杓子定規にセットされてしまうと、本当に0歳の顧客なのか、ただ単に年齢情報をまだ入稿していないのか、見分けがつかなくなってしまう。

特性1~3を満たすストレージとして、RDBMSが自然に想起される（それ以外のストレージを否定はしていない）。しかしRDBMSは、通常、特性4, 6を満たさない。

つまり、
**デジタルアーカイブのためのDBMSにはRDBMSが有望であるが、スキーマ変更の際の既存レコードの取り扱いに難があるため、スキーマ定義・入稿サイクルを回す用途にはRDBMSでは不足**
という課題がある。
