<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/en/blog/rss.xml" title="apllodb  Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/en/blog/atom.xml" title="apllodb  Blog Atom Feed"><title data-react-helmet="true">Immutable Schema | apllodb </title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://apllodb.github.io/en/ImmutableSchema/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Immutable Schema | apllodb "><meta data-react-helmet="true" name="description" content="As described in Introduction, Immutable Schema consists of Immutable DDL and Immutable DML."><meta data-react-helmet="true" property="og:description" content="As described in Introduction, Immutable Schema consists of Immutable DDL and Immutable DML."><link data-react-helmet="true" rel="shortcut icon" href="/en/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://apllodb.github.io/en/ImmutableSchema/"><link data-react-helmet="true" rel="alternate" href="https://apllodb.github.io/ImmutableSchema/" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://apllodb.github.io/en/ImmutableSchema/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apllodb.github.io/ImmutableSchema/" hreflang="x-default"><link rel="stylesheet" href="/en/assets/css/styles.cec9e29a.css">
<link rel="preload" href="/en/assets/js/runtime~main.413d6baa.js" as="script">
<link rel="preload" href="/en/assets/js/main.08b7bf15.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/en/"><img src="/en/img/logo.svg" alt="apllodb Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/en/img/logo.svg" alt="apllodb Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/en/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apllodb/apllodb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>en</span></span></a><ul class="dropdown__menu"><li><a href="/ImmutableSchema/" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ja</a></li><li><a href="/en/ImmutableSchema/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">en</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/">apllodb documentation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/introduction/">Introduction</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/en/ImmutableSchema/">Immutable Schema</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/en/future-work/">Future Development Plan</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Immutable Schema</h1></header><p>As described in <a href="/en/introduction/">Introduction</a>, Immutable Schema consists of Immutable DDL and Immutable DML.
Immutable Schema enables the organization of new information obtained through observation of data  for digital material management  without destroying existing data (records).</p><p>This chapter describes the specifications of Immutable DDL and Immutable DML, and some implementation details in v0.1.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="immutable-ddl-overview"></a>Immutable DDL Overview<a class="hash-link" href="#immutable-ddl-overview" title="Direct link to heading">#</a></h2><p>In DDL of a normal RDBMS, table definitions created with the <code>CREATE TABLE</code> statement can be modified with the <code>ALTER TABLE</code> statement or dropped with the <code>DROP TABLE</code> statement.
If a table definition is modified (dropped) with <code>ALTER TABLE</code> or <code>DROP TABLE</code>, the original table definition cannot be recovered.</p><p>Immutable DDL makes this possible.
In Immutable DDL, a table has <strong>versions</strong>.</p><ul><li><code>CREATE TABLE t ... </code> creates <code>v1</code> of table <code>t</code>.</li><li>Then <code>ALTER TABLE t ... </code> creates <code>v2</code> of table <code>t</code>. The table definition of <code>v1</code> and the records inside <code>v1</code> will remain unchanged.</li><li>Then <code>DROP TABLE t</code> will create <code>v3</code> of table <code>t</code> as in deactivated state. Since <code>v3</code> is in deactivated state, any operation on <code>t</code> will fail basically. The records associated with <code>v1</code> and <code>v2</code> remain intact.</li></ul><p>The behavior in the case of <code>ALTER TABLE</code> is illustrated below.</p><p><img alt="`ALTER TABLE ... ADD`" src="/en/assets/images/immutable-ddl-alter-table-add.en-11a4e12a58cf4955cb19a52fdd1e7f04.png"></p><p><em>Quoted from <a href="https://docs.google.com/presentation/d/e/2PACX-1vTxGlW6UwmR-fHAIki1IPb7zFy7mQ0WRBFywsN_3S5jm6CdekF9qhxT3DYezBzHtx5S1bX5XiHeOACk/pub?start=false&amp;loop=false&amp;delayms=3000" target="_blank" rel="noopener noreferrer">&quot;Introduction to apllodb&quot; slides</a></em>.</p><p><code>ADD COLUMN</code> adding a <code>NOT NULL</code> column without any default value is not possible in a normal RDBMS because it doesn&#x27;t know what value to set to the new column of an existing record.
With Immutable DDL, <code>v2</code> is created without error. Table definition before adding the column remains as <code>v1</code> and records are kept in <code>v1</code>.
Next INSERT will be directed to <code>v2</code> if the value is also set for the added column.</p><p>Next, let&#x27;s look at an example of <code>DROP COLUMN</code>.</p><p><img alt="`ALTER TABLE ... DROP`" src="/en/assets/images/immutable-ddl-alter-table-drop.en-8f7d77014f38099cbd0bfc937d979f8d.png"></p><p><em>Quoted from <a href="https://docs.google.com/presentation/d/e/2PACX-1vTxGlW6UwmR-fHAIki1IPb7zFy7mQ0WRBFywsN_3S5jm6CdekF9qhxT3DYezBzHtx5S1bX5XiHeOACk/pub?start=false&amp;loop=false&amp;delayms=3000" target="_blank" rel="noopener noreferrer">&quot;Introduction to apllodb&quot; slides</a></em>.</p><p>In a normal RDBMS, column values will also disappear from existing records. There is nothing wrong with this behavior, but in the case of digital document management, there may be a case where you don&#x27;t want to fill this column anymore, but want to keep the column values you have filled so far.
In this case, Immutable DDL can be useful. Even if you delete a column from a table definition, the table definition and records before the column deletion will remain in <code>v1</code>.</p><p>So far, we have explained that issuing DDL creates a new version in the table definition, and the records are still associated with old versions.
In the next section, we will explain how DML such as <code>SELECT</code> and <code>INSERT</code> behaves in a situation where multiple versions exist.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="details-of-immutable-ddl"></a>Details of Immutable DDL.<a class="hash-link" href="#details-of-immutable-ddl" title="Direct link to heading">#</a></h2><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="select-behavior"></a>SELECT behavior<a class="hash-link" href="#select-behavior" title="Direct link to heading">#</a></h2><p>When the <code>SELECT</code> target table is <code>t</code>, all versions (not deactivated via <code>DROP TABLE</code>) will be processed according to the following rules.</p><ul><li><strong>(Rule 1)</strong> Error if the column <code>c</code> in the <code>SELECT</code> statement does not exist in any version of <code>t</code>.</li><li><strong>(Rule 2)</strong> If <code>c</code> exists in some version of <code>t</code>, records in that version return the column value for <code>c</code>.</li><li><strong>(Rule 3)</strong> If <code>c</code> column does not exist in some version, records of that version return NULL value for <code>c</code>.</li></ul><p>Let&#x27;s explain with an example.
Consider the following three versions and records are in table <code>t</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">v3</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| c1 | c2 |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|----|----|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| 1  | 10 |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v2</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| c1 | c2 | c3 |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|----|----|----|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| 3  | 30 | 33 |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">v1</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| c1 |</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">|----|</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">| 2  |</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At this time, the</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> c4 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>will result in an error according to rule 1 (the column c4 does not exist).</p><p>Let&#x27;s look at some other examples.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> c1 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- result (in undefined order)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c1 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">----|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Rule 2 is applied.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- result (undefined order)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c1 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c2   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c3   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">----|------|------|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Rules 2 and 3 are applied.</p><p>So far, we&#x27;ve learned Projection (specifying the columns to fetch immediately after the <code>SELECT</code>), let&#x27;s look at</p><ul><li><code>WHERE</code></li><li><code>GROUP BY</code></li><li><code>ORDER BY</code></li><li><code>JOIN</code></li></ul><p>The same rules apply to the columns that appear in the above clauses.
By rule 3, NULL may appear but these operations have defined behavior as SQL standard when NULL appears<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>, and return the result according to that specifications.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t </span><span class="token keyword" style="font-style:italic">WHERE</span><span class="token plain"> c2 </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- result</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c1 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c2 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c3 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">----|------|------|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">SELECT</span><span class="token plain"> c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c3 </span><span class="token keyword" style="font-style:italic">FROM</span><span class="token plain"> t </span><span class="token keyword" style="font-style:italic">ORDER</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">BY</span><span class="token plain"> c2 </span><span class="token keyword" style="font-style:italic">DESC</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">-- result (NULL is subordinate to any value)</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c1 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c2 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> c3 </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">----|------|------|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain">   </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"></span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain">  </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">NULL</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">|</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> <code>GROUP BY nullable_column</code>, for example, have different default behavior depending on RDBMS implementations. apllodb v0.1 adopts PostgreSQL compliant semantics.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="insert-behavior"></a>INSERT behavior<a class="hash-link" href="#insert-behavior" title="Direct link to heading">#</a></h3><p>When the table to be <code>INSERT</code>ed is <code>t</code>, all versions (not deactivated by <code>DROP TABLE</code>) will be processed according to the following rules.</p><ul><li><strong>(Rule 1)</strong> Iterate versions in descending order, and attempt to insert a record into a version if an insert with an <code>INSERT</code> statement can be performed successfully for that version.<ul><li><strong>(Rule 1.1)</strong> Error if a table-wide constraint is violated.</li><li><strong>(Rule 1.2)</strong> Otherwise, insert into that version completes successfully.</li></ul></li><li><strong>(Rule 2)</strong> If rule 1 does not work for one version, choose a smaller version and repeat.</li><li><strong>(Rule 3)</strong> If the insertion into <code>v1</code> does not complete successfully, the execution of the <code>INSERT</code> statement will fail.</li></ul><p>Let&#x27;s explain with an example.
Consider the case where the table <code>t</code> has the following three versions and a table-wide constraint</p><ul><li>v3<ul><li><code>c1</code>: NOT NULL</li><li><code>c2</code>: NOT NULL</li></ul></li><li>v2<ul><li><code>c1</code>: NOT NULL</li><li><code>c2</code>: NOT NULL</li><li><code>c3</code>: NULL</li></ul></li><li>v1<ul><li><code>c1</code>: NOT NULL</li></ul></li><li>Table-wide constraints<ul><li><code>id</code>: PRIMARY KEY</li></ul></li></ul><p>Let&#x27;s look at a few <code>INSERT</code> statements and their results.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Following rule 1, apllodb will first try to insert into <code>v3</code>. Insertion into <code>v3</code> is OK, so rule 1.2 will complete the INSERT statement successfully.
(Inserting into <code>v2</code> is also possible, but <code>v2</code> will not be selected, since the INSERT candidates are ordered by descending version.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">33</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Following rule 1, apllodb first try to insert into <code>v3</code>. Since <code>v3</code> does not have a column named <code>c3</code>, apllodb move to rule 2, and then back to rule 1 with an attempt on <code>v2</code>.
Inserting into <code>v2</code> is OK, so rule 1.2 will complete the INSERT statement successfully.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Both <code>v3</code> and <code>v2</code> will fail because they require <code>c2</code>.  <code>v1</code> completes successfully.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Since none of <code>v3</code>, <code>v2</code>, or <code>v1</code> has <code>c4</code>, rule 3 causes this INSERT statement to fail.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sql"><pre tabindex="0" class="prism-code language-sql codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">INSERT</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">INTO</span><span class="token plain"> t </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">c1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> c3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">VALUES</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">111</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p><code>v3</code> does not have <code>c3</code>, so it tries to insert into <code>v2</code>.
Since the record with <code>c1 = 1</code> already exists, it violates the table-wide constraint <code>c1 PRIMARY KEY</code>. Therefore, according to rule 1.1, this INSERT statement will result in an error.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="immutable-dml-overview"></a>Immutable DML Overview<a class="hash-link" href="#immutable-dml-overview" title="Direct link to heading">#</a></h2><p>In a normal RDBMS DML, a record created with an <code>INSERT</code> statement can be updated with an <code>UPDATE</code> statement or deleted with a <code>DELETE</code> statement.
If a record is updated (deleted) by <code>UPDATE</code> or <code>DELETE</code>, the original record cannot be recovered <sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup>.</p><p>Immutable DML allows records to have <strong>revision</strong> and to be restored to a previous revision.</p><ul><li>A table always has a primary key, and the primary key is the same for all versions.</li><li>There is a one-to-many association between primary keys and revisions.</li><li>The first time the value of a primary key is created by an <code>INSERT</code> statement, the record will be in the <code>r1</code> revision.</li><li>When the record of the primary key is updated by an <code>UPDATE</code> statement, the record of <code>r1</code> remains unchanged, and the record of <code>r2</code> is created (internally, the <code>INSERT</code> process runs).</li><li>When a record with the same primary key is deleted by a <code>DELETE</code> statement, the record of <code>r3</code> is created with only a delete mark and no content.</li><li>In <code>SELECT</code>, only the latest revision of the same primary key is retrieved. If the latest revision has a delete mark, the record of the primary key will not be retrieved.</li></ul><p>Here is an illustration of the behavior in the case of <code>UPDATE</code>.</p><p><img alt="`UPDATE`" src="/en/assets/images/immutable-dml-update.en-aaacbc62a22e36f5711093764ac10140.png"></p><p><em>Quoted from <a href="https://docs.google.com/presentation/d/e/2PACX-1vTxGlW6UwmR-fHAIki1IPb7zFy7mQ0WRBFywsN_3S5jm6CdekF9qhxT3DYezBzHtx5S1bX5XiHeOACk/pub?start=false&amp;loop=false&amp;delayms=3000" target="_blank" rel="noopener noreferrer">&quot;Introduction to apllodb&quot; slide</a></em>.</p><p>In a normal RDBMS, the value of <code>c1</code> is overwritten by <code>UPDATE</code> and cannot usually be restored to its original value <sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup>.
In digital document management, we believe that we often want to revert records they were before modified or deleted.
In Immutable DML, past records remain in the form of revisions, which can be recovered if necessary. It is also possible to extract the change history of a record.</p><p><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup> Some RDBMSs have destructive DMLs like UPDATE and DELETE in append-manner like Immutable DML. Many of them perform garbage collection at some point (background processing, <code>VACUUM</code> command, etc.) to complete destructive DML. The aim is to reduce capacity and improve performance.</p><p><sup id="fnref-3"><a href="#fn-3" class="footnote-ref">3</a></sup> Possible if you have snapshot backups but we don&#x27;t think many systems support record-by-record recovery.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="immutable-ddl-and-immutable-dml-implementations"></a>Immutable DDL and Immutable DML implementations<a class="hash-link" href="#immutable-ddl-and-immutable-dml-implementations" title="Direct link to heading">#</a></h2><p>apllodb v0.1 uses SQLite for table structure and record storage (and transaction).
Immutable DDL and Immutable DML are also implemented over SQLite.</p><p>In this section, we will explain how to realize Immutable Schema based on existing RDBMS.</p><p><img alt="ER diagram for Immutable Schema realization" src="/en/assets/images/apllodb-0.1.0-SQLite-ER-diagram-a308ac17fd78cf8a5a46691610788b6b.svg"></p><p>We will set up tables as shown in the above figure in the existing RDBMS.
The layer with blue background is the real tables that need to be created for one table <code>T</code> in Immutable Schema.
The figure above shows a setup where table <code>T</code> has two versions, <code>v1</code> and <code>v2</code>.</p><p>The role of each table is as follows</p><ul><li>Physical tables for all apllodb&#x27;s tables<ul><li><code>_vtable_metadata</code>.<ul><li>Manages the metadata for the table.<ul><li>Currently, constraints table-wide constraints (PRIMARY KEY, UNIQUE) for metadata.</li></ul></li></ul></li><li><code>_version_metadata</code>.<ul><li>Manage metadata for each version.<ul><li>Version number</li><li>Name and data type of each column.</li><li>Constraints to check one record at a time (NOT NULL, DEFAULT, CHECK, ...)</li><li>Active version (not being <code>DROP TABLE</code>ed)</li></ul></li></ul></li></ul></li><li>Real table for table `T<ul><li><code>T__navi</code>.<ul><li>A relay table for locating the entity of a record with a primary key.<ul><li>Also supports composite primary keys.</li></ul></li><li>It has a revision number, and &quot;the latest revision with a primary key value&quot; is found in this table.</li><li>It has a version number and can be used to join non-primary key column values with the <code>T__v?</code> table.</li></ul></li><li><code>T__v?</code>.<ul><li>holds the records (non-primary key columns) of version <code>v?</code>.</li></ul></li></ul></li></ul><p>See <a href="https://github.com/apllodb/apllodb/tree/main/apllodb-immutable-schema-engine#sqlite-schema-design" target="_blank" rel="noopener noreferrer">README of the storage engine</a> for details of columns in the real table.</p><p>Here is an overview of how these tables are referenced in a <code>SELECT</code> statement.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="full-scan-case"></a>Full scan case<a class="hash-link" href="#full-scan-case" title="Direct link to heading">#</a></h3><ol><li>Browse the <code>T__navi</code> table and extract the record with the highest revision number for each primary key value.</li><li>Get the non-primary key column values of those records by joining them with the <code>T__v?</code> table.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="exact-match-search-by-primary-key"></a>Exact match search by primary key<a class="hash-link" href="#exact-match-search-by-primary-key" title="Direct link to heading">#</a></h3><ol><li>Refer to the <code>T__navi</code> table, do a match search for the primary key value, and extract the record with the highest revision number.</li><li>Get the non-primary key column value of the record by joining it with the <code>T__v?</code> table.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="range-search-by-primary-key"></a>Range search by primary key<a class="hash-link" href="#range-search-by-primary-key" title="Direct link to heading">#</a></h3><ol><li>Refer to the <code>T__navi</code> table, do a range search for the primary key value, and extract the record with the highest revision number.</li><li>Get the non-primary key column value of the record by joining it with the <code>T__v?</code> table.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="exact-match-search-and-range-search-by-non-primary-key"></a>Exact match search and range search by non-primary key.<a class="hash-link" href="#exact-match-search-and-range-search-by-non-primary-key" title="Direct link to heading">#</a></h3><p>Indexes on non-primary keys are not supported in apllodb v0.1. Current apllodb performs performs full scan and then filter-out record that do not match the search criteria.</p><p>When we support indexing, we envision that the primary key can be subtracted from the index and from there it can be dropped into the &quot;For match search by primary key&quot;.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apllodb/apllodb.github.io/docs/03-immutable-schema.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/en/introduction/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Introduction</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/en/future-work/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Future Development Plan Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#immutable-ddl-overview" class="table-of-contents__link">Immutable DDL Overview</a></li><li><a href="#details-of-immutable-ddl" class="table-of-contents__link">Details of Immutable DDL.</a></li><li><a href="#select-behavior" class="table-of-contents__link">SELECT behavior</a><ul><li><a href="#insert-behavior" class="table-of-contents__link">INSERT behavior</a></li></ul></li><li><a href="#immutable-dml-overview" class="table-of-contents__link">Immutable DML Overview</a></li><li><a href="#immutable-ddl-and-immutable-dml-implementations" class="table-of-contents__link">Immutable DDL and Immutable DML implementations</a><ul><li><a href="#full-scan-case" class="table-of-contents__link">Full scan case</a></li><li><a href="#exact-match-search-by-primary-key" class="table-of-contents__link">Exact match search by primary key</a></li><li><a href="#range-search-by-primary-key" class="table-of-contents__link">Range search by primary key</a></li><li><a href="#exact-match-search-and-range-search-by-non-primary-key" class="table-of-contents__link">Exact match search and range search by non-primary key.</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Eukarya, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/en/assets/js/runtime~main.413d6baa.js"></script>
<script src="/en/assets/js/main.08b7bf15.js"></script>
</body>
</html>